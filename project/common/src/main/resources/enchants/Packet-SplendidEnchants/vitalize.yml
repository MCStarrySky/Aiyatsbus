

#         Powered by TabooLib 6.1         #


basic:
  id: vitalize
  name: "急救"
  max_level: 3

rarity: 传奇
targets:
  - 盾牌

limitations: [ ]

display:
  description:
    general: "受到攻击时若生命值较低则恢复生命值 &7(冷却:&a{冷却时间}秒&7)"
    specific: "&7受到攻击时若生命值不超过&a{阈值}&7则恢复&a{恢复}&7最大生命值 (&7冷却:&a{冷却}&7)"

alternative:
  is_tradeable: false

variables:
  leveled:
    阈值: "%:5*{level}"
    恢复: "%:40+15*{level}"
    冷却: "秒:105-15*{level}"

mechanisms:
  listeners:
    on-damage:
      listen: 'entity-damage'
      handle: |-
        set max-health to type double &event[entity.max-health]
        set health to type double &event[entity.health]
        set threshold to type double &阈值
        if check health <= calc "threshold * max-health" then {
          set cd to a-cd check &enchant &player type double &冷却时间 false
          if &cd then {
            set multiplier to type double &恢复
            set &event[entity.health] to calc "health * (1 + multiplier)"
            a-cd add &enchant &player
            send-lang enchant-vitalize-recovered to &event[entity] with array [ &恢复 ]
          }
        }
